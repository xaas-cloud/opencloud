{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Listen for Xdebug",
      "type": "php",
      "request": "launch",
      "port": 9003
    },
    {
      "name": "Debug remote :40000",
      "type": "go",
      "request": "attach",
      "mode": "remote",
      "port": 40000
    },
    {
      "name": "OpenCloud server",
      "type": "go",
      "request": "launch",
      "mode": "debug",
      "buildFlags": [
        // "-tags", "enable_vips"
      ],
      "program": "${workspaceFolder}/opencloud/cmd/opencloud",
      "args": ["server"],
      "env": {
        // log settings for human developers
        "OC_LOG_LEVEL": "debug",
        "OC_LOG_PRETTY": "true",
        "OC_LOG_COLOR": "true",
        // set insecure options because we don't have valid certificates in dev environments
        "OC_INSECURE": "true",
        // enable basic auth for dev setup so that we can use curl for testing
        "PROXY_ENABLE_BASIC_AUTH": "true",
        // demo users
        "IDM_CREATE_DEMO_USERS": "true",
        // OC_RUN_SERVICES allows to start a subset of services even in the supervised mode
        //"OC_RUN_SERVICES": "settings,storage-system,graph,idp,idm,ocs,store,thumbnails,web,webdav,frontend,gateway,users,groups,auth-basic,storage-authmachine,storage-users,storage-shares,storage-publiclink,storage-system,app-provider,sharing,proxy,ocdav",

        /*
         * Keep secrets and passwords in one block to allow easy uncommenting
         */
        // user id of "admin", for user creation and admin role assignement
        "OC_ADMIN_USER_ID": "some-admin-user-id-0000-000000000000", // FIXME currently must have the length of a UUID, see reva/pkg/storage/utils/decomposedfs/spaces.go:228
        // admin user default password
        "IDM_ADMIN_PASSWORD": "admin",
        // system user
        "OC_SYSTEM_USER_ID": "some-system-user-id-000-000000000000", // FIXME currently must have the length of a UUID, see reva/pkg/storage/utils/decomposedfs/spaces.go:228
        "OC_SYSTEM_USER_API_KEY": "some-system-user-machine-auth-api-key",
        // set some hardcoded secrets
        "OC_JWT_SECRET": "some-opencloud-jwt-secret",
        "OC_MACHINE_AUTH_API_KEY": "some-opencloud-machine-auth-api-key",
        "OC_TRANSFER_SECRET": "some-opencloud-transfer-secret",
        // collaboration
        "COLLABORATION_WOPIAPP_SECRET": "some-wopi-secret",
        // idm ldap
        "IDM_SVC_PASSWORD": "some-ldap-idm-password",
        "GRAPH_LDAP_BIND_PASSWORD": "some-ldap-idm-password",
        // reva ldap
        "IDM_REVASVC_PASSWORD": "some-ldap-reva-password",
        "GROUPS_LDAP_BIND_PASSWORD": "some-ldap-reva-password",
        "USERS_LDAP_BIND_PASSWORD": "some-ldap-reva-password",
        "AUTH_BASIC_LDAP_BIND_PASSWORD": "some-ldap-reva-password",
        // idp ldap
        "IDM_IDPSVC_PASSWORD": "some-ldap-idp-password",
        "IDP_LDAP_BIND_PASSWORD": "some-ldap-idp-password",
        // storage users mount ID
        "GATEWAY_STORAGE_USERS_MOUNT_ID": "storage-users-1",
        "STORAGE_USERS_MOUNT_ID": "storage-users-1",
        // graph application ID
        "GRAPH_APPLICATION_ID": "application-1",

        // service accounts
        "OC_SERVICE_ACCOUNT_ID": "service-account-id",
        "OC_SERVICE_ACCOUNT_SECRET": "service-account-secret"
      }
    },
    {
      "name": "OpenCloud server with Groupware",
      "type": "go",
      "request": "launch",
      "mode": "debug",
      "buildFlags": [
        // "-tags", "enable_vips"
      ],
      "program": "${workspaceFolder}/opencloud/cmd/opencloud",
      "args": ["server"],
      "env": {
        // log settings for human developers
        "OC_LOG_LEVEL": "info",
        "OC_LOG_PRETTY": "true",
        "OC_LOG_COLOR": "true",
        // set insecure options because we don't have valid certificates in dev environments
        "OC_INSECURE": "true",
        // enable basic auth for dev setup so that we can use curl for testing
        "PROXY_ENABLE_BASIC_AUTH": "true",
        // demo users
        "IDM_CREATE_DEMO_USERS": "true",
        // OC_RUN_SERVICES allows to start a subset of services even in the supervised mode
        //"OC_RUN_SERVICES": "settings,storage-system,graph,idp,idm,ocs,store,thumbnails,web,webdav,frontend,gateway,users,groups,auth-basic,storage-authmachine,storage-users,storage-shares,storage-publiclink,storage-system,app-provider,sharing,proxy,ocdav",

        /*
         * Keep secrets and passwords in one block to allow easy uncommenting
         */
        // user id of "admin", for user creation and admin role assignement
        "OC_ADMIN_USER_ID": "some-admin-user-id-0000-000000000000", // FIXME currently must have the length of a UUID, see reva/pkg/storage/utils/decomposedfs/spaces.go:228
        // admin user default password
        "IDM_ADMIN_PASSWORD": "admin",
        // system user
        "OC_SYSTEM_USER_ID": "some-system-user-id-000-000000000000", // FIXME currently must have the length of a UUID, see reva/pkg/storage/utils/decomposedfs/spaces.go:228
        "OC_SYSTEM_USER_API_KEY": "some-system-user-machine-auth-api-key",
        // set some hardcoded secrets
        "OC_JWT_SECRET": "some-opencloud-jwt-secret",
        "OC_MACHINE_AUTH_API_KEY": "some-opencloud-machine-auth-api-key",
        "OC_TRANSFER_SECRET": "some-opencloud-transfer-secret",
        // collaboration
        "COLLABORATION_WOPIAPP_SECRET": "some-wopi-secret",
        // idm ldap
        "IDM_SVC_PASSWORD": "some-ldap-idm-password",
        "GRAPH_LDAP_BIND_PASSWORD": "some-ldap-idm-password",
        // reva ldap
        "IDM_REVASVC_PASSWORD": "some-ldap-reva-password",
        "GROUPS_LDAP_BIND_PASSWORD": "some-ldap-reva-password",
        "USERS_LDAP_BIND_PASSWORD": "some-ldap-reva-password",
        "AUTH_BASIC_LDAP_BIND_PASSWORD": "some-ldap-reva-password",
        // idp ldap
        "IDM_IDPSVC_PASSWORD": "some-ldap-idp-password",
        "IDP_LDAP_BIND_PASSWORD": "some-ldap-idp-password",
        // storage users mount ID
        "GATEWAY_STORAGE_USERS_MOUNT_ID": "storage-users-1",
        "STORAGE_USERS_MOUNT_ID": "storage-users-1",
        // graph application ID
        "GRAPH_APPLICATION_ID": "application-1",

        // service accounts
        "OC_SERVICE_ACCOUNT_ID": "service-account-id",
        "OC_SERVICE_ACCOUNT_SECRET": "service-account-secret",

        "OC_ADD_RUN_SERVICES": "groupware",
        "GROUPWARE_LOG_LEVEL": "trace"
      }
    },
    {
      "name": "OpenCloud server with external services",
      "type": "go",
      "request": "launch",
      "mode": "debug",
      "buildFlags": [
        // "-tags", "enable_vips"
      ],
      "program": "${workspaceFolder}/opencloud/cmd/opencloud",
      "args": ["server"],
      "env": {
        "OC_URL": "https://localhost:9200/",
        "PROXY_DEBUG_ADDR": "0.0.0.0:9205",
        "OC_BASE_DATA_PATH": "${env:HOME}/.opencloud-with-external",
        "OC_CONFIG_DIR": "${env:HOME}/.opencloud-with-external/config",
        "GROUPWARE_LOG_LEVEL": "trace",
        "OC_LOG_LEVEL": "info",
        "OC_LOG_PRETTY": "true",
        "OC_LOG_COLOR": "true",
        "OC_INSECURE": "true",
        "PROXY_ENABLE_BASIC_AUTH": "false",
        "IDM_CREATE_DEMO_USERS": "false",
        "OC_LDAP_URI": "ldaps://localhost:636",
        "OC_LDAP_INSECURE": "true",
        "OC_LDAP_BIND_DN": "cn=admin,dc=opencloud,dc=eu",
        "OC_LDAP_BIND_PASSWORD": "admin",
        "OC_LDAP_GROUP_BASE_DN": "ou=groups,dc=opencloud,dc=eu",
        "OC_LDAP_GROUP_SCHEMA_ID": "entryUUID",
        "OC_LDAP_USER_BASE_DN": "ou=users,dc=opencloud,dc=eu",
        "OC_LDAP_USER_FILTER": "(objectclass=inetOrgPerson)",
        "OC_LDAP_USER_SCHEMA_ID": "entryUUID",
        "OC_LDAP_DISABLE_USER_MECHANISM": "none",
        "OC_LDAP_SERVER_WRITE_ENABLED": "false",
        "OC_EXCLUDE_RUN_SERVICES": "idm",
        "OC_ADD_RUN_SERVICES": "notifications,groupware",
        "NATS_NATS_HOST": "0.0.0.0",
        "NATS_NATS_PORT": "9233",
        "FRONTEND_ARCHIVER_MAX_SIZE": "10000000000",
        "MICRO_REGISTRY_ADDRESS": "127.0.0.1:9233",
        "NOTIFICATIONS_SMTP_HOST": "localhost",
        "NOTIFICATIONS_SMTP_PORT": "2500",
        "NOTIFICATIONS_SMTP_SENDER": "OpenCloud notifications <notifications@cloud.opencloud.test>",
        "NOTIFICATIONS_SMTP_USERNAME": "notifications@cloud.opencloud.test",
        "NOTIFICATIONS_SMTP_INSECURE": "true",
        "NOTIFICATIONS_SMTP_PASSWORD": "",
        "NOTIFICATIONS_SMTP_AUTHENTICATION": "",
        "NOTIFICATIONS_SMTP_ENCRYPTION": "none",
        "PROXY_AUTOPROVISION_ACCOUNTS": "false",
        "PROXY_ROLE_ASSIGNMENT_DRIVER": "oidc",
        "OC_OIDC_ISSUER": "https://keycloak.opencloud.test/realms/openCloud",
        "PROXY_OIDC_REWRITE_WELLKNOWN": "true",
        "WEB_OIDC_CLIENT_ID": "web",
        "PROXY_USER_OIDC_CLAIM": "uuid",
        "PROXY_USER_CS3_CLAIM": "userid",
        "WEB_OPTION_ACCOUNT_EDIT_LINK_HREF": "https://keycloak.opencloud.test/realms/openCloud/account",
        "OC_ADMIN_USER_ID": "",
        "SETTINGS_SETUP_DEFAULT_ASSIGNMENTS": "false",
        "GRAPH_ASSIGN_DEFAULT_USER_ROLE": "false",
        "GRAPH_USERNAME_MATCH": "none",
        "KEYCLOAK_DOMAIN": "keycloak.opencloud.test",
        "IDM_ADMIN_PASSWORD": "admin",
        "GRAPH_LDAP_SERVER_UUID": "true",
        "GRAPH_LDAP_GROUP_CREATE_BASE_DN": "ou=custom,ou=groups,dc=opencloud,dc=eu",
        "GRAPH_LDAP_REFINT_ENABLED": "true",
        "GATEWAY_GRPC_ADDR": "0.0.0.0:9142",
      }
    },
    {
      "name": "Fed OpenCloud server",
      "type": "go",
      "request": "launch",
      "mode": "debug",
      "program": "${workspaceFolder}/opencloud/cmd/opencloud/main.go",
      "args": ["server"],
      "env": {
        "WEB_UI_CONFIG_FILE": "${workspaceFolder}/tests/config/local/fed-opencloud-web.json",
        "OCM_OCM_PROVIDER_AUTHORIZER_PROVIDERS_FILE": "${workspaceFolder}/tests/config/local/providers.json",
        "OCM_OCM_INVITE_MANAGER_INSECURE": "true",
        "OCM_OCM_SHARE_PROVIDER_INSECURE": "true",
        "OCM_OCM_STORAGE_PROVIDER_INSECURE": "true",
        "OC_BASE_DATA_PATH": "${env:HOME}/.opencloud-10200",
        "OC_CONFIG_DIR": "${env:HOME}/.opencloud-10200/config",
        "OC_EVENTS_ENDPOINT": "127.0.0.1:10233",
        "OC_LDAP_URI": "ldaps://localhost:10235",
        "OC_RUNTIME_PORT": "10250",
        "OC_URL": "https://localhost:10200",
        "OC_ADD_RUN_SERVICES": "ocm",
        "OC_ENABLE_OCM": "true",
        "APP_PROVIDER_DEBUG_ADDR": "127.0.0.1:10165",
        "APP_PROVIDER_GRPC_ADDR": "127.0.0.1:10164",
        "APP_REGISTRY_DEBUG_ADDR": "127.0.0.1:10243",
        "APP_REGISTRY_GRPC_ADDR": "127.0.0.1:10242",
        "AUTH_APP_DEBUG_ADDR": "127.0.0.1:10245",
        "AUTH_APP_GRPC_ADDR": "127.0.0.1:10246",
        "AUTH_APP_HTTP_ADDR": "127.0.0.1:10247",
        "AUTH_BASIC_DEBUG_ADDR": "127.0.0.1:10147",
        "AUTH_BASIC_GRPC_ADDR": "127.0.0.1:10146",
        "AUTH_MACHINE_DEBUG_ADDR": "127.0.0.1:10167",
        "AUTH_MACHINE_GRPC_ADDR": "127.0.0.1:10166",
        "AUTH_SERVICE_DEBUG_ADDR": "127.0.0.1:10169",
        "AUTH_SERVICE_GRPC_ADDR": "127.0.0.1:10199",
        "CLIENTLOG_DEBUG_ADDR": "127.0.0.1:10260",
        "ACTIVITYLOG_HTTP_ADDR": "127.0.0.1:10195",
        "ACTIVITYLOG_DEBUG_ADDR": "127.0.0.1:10261",
        "EVENTHISTORY_GRPC_ADDR": "127.0.0.1:10274",
        "EVENTHISTORY_DEBUG_ADDR": "127.0.0.1:10270",
        "FRONTEND_DEBUG_ADDR": "127.0.0.1:10141",
        "FRONTEND_HTTP_ADDR": "127.0.0.1:10140",
        "GATEWAY_DEBUG_ADDR": "127.0.0.1:10143",
        "GATEWAY_GRPC_ADDR": "127.0.0.1:10142",
        "GRAPH_DEBUG_ADDR": "127.0.0.1:10124",
        "GRAPH_HTTP_ADDR": "127.0.0.1:10120",
        "GROUPS_DEBUG_ADDR": "127.0.0.1:10161",
        "GROUPS_GRPC_ADDR": "127.0.0.1:10160",
        "IDM_DEBUG_ADDR": "127.0.0.1:10239",
        "IDM_LDAPS_ADDR": "127.0.0.1:10235",
        "IDP_DEBUG_ADDR": "127.0.0.1:10134",
        "IDP_HTTP_ADDR": "127.0.0.1:10130",
        "NATS_DEBUG_ADDR": "127.0.0.1:10234",
        "NATS_NATS_PORT": "10233",
        "OCDAV_HTTP_ADDR": "127.0.0.1:10350",
        "OCDAV_DEBUG_ADDR": "127.0.0.1:10163",
        "OCM_DEBUG_ADDR": "127.0.0.1:10281",
        "OCM_HTTP_ADDR": "127.0.0.1:10280",
        "OCM_GRPC_ADDR": "127.0.0.1:10282",
        "OCS_DEBUG_ADDR": "127.0.0.1:10114",
        "OCS_HTTP_ADDR": "127.0.0.1:10110",
        "POSTPROCESSING_DEBUG_ADDR": "127.0.0.1:10255",
        "POSTPROCESSING_SERVICE_DEBUG_ADDR": "127.0.0.1:10255",
        "PROXY_DEBUG_ADDR": "127.0.0.1:10205",
        "PROXY_HTTP_ADDR": "127.0.0.1:10200",
        "SEARCH_DEBUG_ADDR": "127.0.0.1:10224",
        "SEARCH_GRPC_ADDR": "127.0.0.1:10220",
        "SETTINGS_DEBUG_ADDR": "127.0.0.1:10189",
        "SETTINGS_GRPC_ADDR": "127.0.0.1:10185",
        "SETTINGS_HTTP_ADDR": "127.0.0.1:10186",
        "SHARING_DEBUG_ADDR": "127.0.0.1:10151",
        "SHARING_GRPC_ADDR": "127.0.0.1:10150",
        "SSE_HTTP_ADDR": "127.0.0.1:10132",
        "SSE_DEBUG_ADDR": "127.0.0.1:10135",
        "STORAGE_PUBLICLINK_DEBUG_ADDR": "127.0.0.1:10179",
        "STORAGE_PUBLICLINK_GRPC_ADDR": "127.0.0.1:10178",
        "STORAGE_SHARES_DEBUG_ADDR": "127.0.0.1:10156",
        "STORAGE_SHARES_GRPC_ADDR": "127.0.0.1:10154",
        "STORAGE_SYSTEM_DATA_SERVER_URL": "http://localhost:10216/data",
        "STORAGE_SYSTEM_DEBUG_ADDR": "127.0.0.1:10217",
        "STORAGE_SYSTEM_GRPC_ADDR": "127.0.0.1:10215",
        "STORAGE_SYSTEM_HTTP_ADDR": "127.0.0.1:10216",
        "STORAGE_USERS_DEBUG_ADDR": "127.0.0.1:10159",
        "STORAGE_USERS_GRPC_ADDR": "127.0.0.1:10157",
        "STORAGE_USERS_HTTP_ADDR": "127.0.0.1:10158",
        "STORAGE_USERS_DATA_SERVER_URL": "http://localhost:10158/data",
        "STORE_DEBUG_ADDR": "127.0.0.1:10464",
        "STORE_GRPC_ADDR": "127.0.0.1:10460",
        "THUMBNAILS_DEBUG_ADDR": "127.0.0.1:10194",
        "THUMBNAILS_GRPC_ADDR": "127.0.0.1:10191",
        "THUMBNAILS_HTTP_ADDR": "127.0.0.1:10190",
        "USERLOG_HTTP_ADDR": "127.0.0.1:10211",
        "USERLOG_DEBUG_ADDR": "127.0.0.1:10210",
        "USERS_DEBUG_ADDR": "127.0.0.1:10145",
        "USERS_GRPC_ADDR": "127.0.0.1:10144",
        "WEB_DEBUG_ADDR": "localhost:10104",
        "WEB_HTTP_ADDR": "localhost:10100",
        "WEBDAV_DEBUG_ADDR": "127.0.0.1:10119",
        "WEBDAV_HTTP_ADDR": "127.0.0.1:10115",
        "WEBFINGER_DEBUG_ADDR": "127.0.0.1:10279",
        "WEBFINGER_HTTP_ADDR": "127.0.0.1:10275",
        "OC_SERVICE_ACCOUNT_ID": "serviceaccount",
        "OC_SERVICE_ACCOUNT_SECRET": "serviceaccountsecret",
        "OC_DECOMPOSEDFS_PROPAGATOR": "async",
        "STORAGE_USERS_ASYNC_PROPAGATOR_PROPAGATION_DELAY": "10s",
        "TLS_INSECURE": "true",
        "OC_INSECURE": "true",
        "IDP_ACCESS_TOKEN_EXPIRATION": "9000",
        "GATEWAY_STORAGE_USERS_MOUNT_ID": "storage-users-1",
        "STORAGE_USERS_MOUNT_ID": "storage-users-1",
        "MICRO_REGISTRY": "memory",
        "SHARING_PUBLIC_DRIVER": "jsoncs3",
        "FRONTEND_OCS_RESOURCE_INFO_CACHE_TTL": "0",
        "OC_LOG_LEVEL": "info",
        "OC_LOG_PRETTY": "true",
        "OC_LOG_COLOR": "true",
        "PROXY_ENABLE_BASIC_AUTH": "true",
        "IDM_CREATE_DEMO_USERS": "true",
        "OC_ADMIN_USER_ID": "some-admin-user-id-0000-000000000000",
        "IDM_ADMIN_PASSWORD": "admin",
        "OC_SYSTEM_USER_ID": "some-system-user-id-000-000000000000",
        "OC_SYSTEM_USER_API_KEY": "some-system-user-machine-auth-api-key",
        "OC_JWT_SECRET": "some-opencloud-jwt-secret",
        "OC_MACHINE_AUTH_API_KEY": "some-opencloud-machine-auth-api-key",
        "OC_TRANSFER_SECRET": "some-opencloud-transfer-secret",
        "IDM_SVC_PASSWORD": "some-ldap-idm-password",
        "GRAPH_LDAP_BIND_PASSWORD": "some-ldap-idm-password",
        "IDM_REVASVC_PASSWORD": "some-ldap-reva-password",
        "GROUPS_LDAP_BIND_PASSWORD": "some-ldap-reva-password",
        "USERS_LDAP_BIND_PASSWORD": "some-ldap-reva-password",
        "AUTH_BASIC_LDAP_BIND_PASSWORD": "some-ldap-reva-password",
        "IDM_IDPSVC_PASSWORD": "some-ldap-idp-password",
        "IDP_LDAP_BIND_PASSWORD": "some-ldap-idp-password",
        "GRAPH_APPLICATION_ID": "application-1"
      }
    }
  ]
}
